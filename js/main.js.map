{"version":3,"file":"main.js","sources":["../src/js/utils/polyfills.js","../src/js/main.js"],"sourcesContent":["/**\n * Various js polyfills\n */\n\n\nclass PolyfillsSingleton {\n\n  constructor() {\n\n  }\n\n  init() {\n    this.initCustomEventPolyfill();\n  }\n\n  initCustomEventPolyfill() {\n    if ( typeof window.CustomEvent === \"function\" ) return false;\n\n    function CustomEvent ( event, params ) {\n      params = params || { bubbles: false, cancelable: false, detail: undefined };\n      var evt = document.createEvent( 'CustomEvent' );\n      evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\n      return evt;\n    }\n\n    CustomEvent.prototype = window.Event.prototype;\n\n    window.CustomEvent = CustomEvent;\n  }\n\n}\n\n\nexport let Polyfills = new PolyfillsSingleton();","/**\n * Main application\n *\n */\n\nimport { Polyfills } from './utils/polyfills';\n\nclass Main {\n  constructor() {\n    Polyfills.init();\n    this.metaKeys = [ [ 'post_title', 'Last Name'], ['first_name', 'First Name'], ['job_title', 'Job Title'], ['company_name', 'Company Name'], ['email', 'Email'], ['phone', 'Phone'], ['session_title', 'Session Title'], ['session_abstract', 'Session Abstract'], ['post_content', 'Bio'] ];\n    this.initUploadListener();\n  }\n\n  initUploadListener() {\n    var inputElement = document.getElementById(\"file-input\");\n    inputElement.addEventListener(\"change\", (event) => this.handleFiles(event), true);\n  }\n\n  handleFiles(e) {\n    var file = e.target.files[0];\n    this.csv = [];\n    var reader = new FileReader();\n    reader.readAsText(file);\n    reader.onloadend = ()=>{\n      let xml = $.parseXML(reader.result);\n      this.$xml = $(xml)\n      this.createCSV();\n      this.saveCSV();\n      this.showOutput();\n    };\n  }\n\n  createCSV() {\n\n    let $items = this.$xml.find(\"item\");\n\n    // set titles\n    let titles = [];\n    this.metaKeys.forEach((key)=> {\n      titles.push('\"' + key[1] + '\"');\n    });\n    titles.push(\"Photo\");\n    this.csv.push(titles);\n\n    $items.each((i, item) => {\n\n      let csvItem = [];\n      let $item = $(item);\n      let $postmeta = $item.find(\"postmeta\");\n\n      this.metaKeys.forEach((key)=> {\n\n        let metaValue = '';\n        $postmeta.each((j, meta)=> {\n          let $meta = $(meta);\n          let metaKey = $meta.find(\"meta_key\").text();\n\n          if (key[0] == metaKey) {\n            metaValue = $meta.find(\"meta_value\").text();\n          }\n        });\n        csvItem.push('\"' + metaValue + '\"');\n      });\n\n      let attachment_url = $item.find(\"attachment_url\").text();\n      csvItem.push(attachment_url);\n\n      this.csv.push(csvItem);\n    });\n  }\n\n  saveCSV() {\n    var csvContent = \"data:text/csv;charset=utf-8,\";\n    this.csv.forEach((infoArray, index)=>{\n      let dataString = infoArray.join(\",\");\n      csvContent += index < this.csv.length ? dataString+ \"\\n\" : dataString;\n    });\n\n    var encodedUri = encodeURI(csvContent);\n    var link = document.createElement(\"a\");\n    link.setAttribute(\"href\", encodedUri);\n    link.setAttribute(\"download\", \"speakers.csv\");\n    document.body.appendChild(link); // Required for FF\n    link.click();\n  }\n\n  showOutput() {\n    let $output = $(\"#output\");\n    $output.show();\n    let $content = $output.find(\".content\");\n    $content.empty();\n\n    this.csv.forEach((item, i) => {\n      if (i > 0) {\n        let $item = $('<div class=\"item mt-5 mb-3\"><h3>Speaker</h3></div>');\n        item.forEach((value, n) => {\n          let key = this.csv[0][n].replace(new RegExp('\"', 'g'), \"\");\n          value = value.replace(new RegExp('\"', 'g'), \"\");\n          let $line = $('<p><strong>' + key + ': </strong><span>' + value + '</span></p>');\n          if (n == item.length - 1) {\n            $line = $('<p><strong>' + key + ': </strong></p><div><img style=\"display:block; max-width: 800px;\" src=\"' + value + '\"></div>');\n          }\n          $item.append($line);\n        });\n        $content.append($item);\n      }\n    });\n\n  }\n\n}\n\ndocument.addEventListener('DOMContentLoaded', event => new Main());\n"],"names":["PolyfillsSingleton","initCustomEventPolyfill","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","prototype","Event","Polyfills","Main","init","metaKeys","initUploadListener","inputElement","getElementById","addEventListener","handleFiles","e","file","target","files","csv","reader","FileReader","readAsText","onloadend","xml","$","parseXML","result","$xml","createCSV","saveCSV","showOutput","$items","find","titles","forEach","key","push","each","i","item","csvItem","$item","$postmeta","metaValue","j","meta","$meta","metaKey","text","attachment_url","csvContent","infoArray","index","dataString","join","length","encodedUri","encodeURI","link","createElement","setAttribute","body","appendChild","click","$output","show","$content","empty","value","n","replace","RegExp","$line","append"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;IAKMA;gCAEU;;;;;;2BAIP;WACAC,uBAAL;;;;8CAGwB;UACnB,OAAOC,OAAOC,WAAd,KAA8B,UAAnC,EAAgD,OAAO,KAAP;;eAEvCA,WAAT,CAAuBC,KAAvB,EAA8BC,MAA9B,EAAuC;iBAC5BA,UAAU,EAAEC,SAAS,KAAX,EAAkBC,YAAY,KAA9B,EAAqCC,QAAQC,SAA7C,EAAnB;YACIC,MAAMC,SAASC,WAAT,CAAsB,aAAtB,CAAV;YACIC,eAAJ,CAAqBT,KAArB,EAA4BC,OAAOC,OAAnC,EAA4CD,OAAOE,UAAnD,EAA+DF,OAAOG,MAAtE;eACOE,GAAP;;;kBAGUI,SAAZ,GAAwBZ,OAAOa,KAAP,CAAaD,SAArC;;aAEOX,WAAP,GAAqBA,WAArB;;;;;;AAMJ,AAAO,IAAIa,YAAY,IAAIhB,kBAAJ,EAAhB;;ACjCP;;;;;AAKA,IAEMiB;kBACU;;;cACFC,IAAV;SACKC,QAAL,GAAgB,CAAE,CAAE,YAAF,EAAgB,WAAhB,CAAF,EAAgC,CAAC,YAAD,EAAe,YAAf,CAAhC,EAA8D,CAAC,WAAD,EAAc,WAAd,CAA9D,EAA0F,CAAC,cAAD,EAAiB,cAAjB,CAA1F,EAA4H,CAAC,OAAD,EAAU,OAAV,CAA5H,EAAgJ,CAAC,OAAD,EAAU,OAAV,CAAhJ,EAAoK,CAAC,eAAD,EAAkB,eAAlB,CAApK,EAAwM,CAAC,kBAAD,EAAqB,kBAArB,CAAxM,EAAkP,CAAC,cAAD,EAAiB,KAAjB,CAAlP,CAAhB;SACKC,kBAAL;;;;;yCAGmB;;;UACfC,eAAeV,SAASW,cAAT,CAAwB,YAAxB,CAAnB;mBACaC,gBAAb,CAA8B,QAA9B,EAAwC,UAACnB,KAAD;eAAW,MAAKoB,WAAL,CAAiBpB,KAAjB,CAAX;OAAxC,EAA4E,IAA5E;;;;gCAGUqB,GAAG;;;UACTC,OAAOD,EAAEE,MAAF,CAASC,KAAT,CAAe,CAAf,CAAX;WACKC,GAAL,GAAW,EAAX;UACIC,SAAS,IAAIC,UAAJ,EAAb;aACOC,UAAP,CAAkBN,IAAlB;aACOO,SAAP,GAAmB,YAAI;YACjBC,MAAMC,EAAEC,QAAF,CAAWN,OAAOO,MAAlB,CAAV;eACKC,IAAL,GAAYH,EAAED,GAAF,CAAZ;eACKK,SAAL;eACKC,OAAL;eACKC,UAAL;OALF;;;;gCASU;;;UAENC,SAAS,KAAKJ,IAAL,CAAUK,IAAV,CAAe,MAAf,CAAb;;;UAGIC,SAAS,EAAb;WACKzB,QAAL,CAAc0B,OAAd,CAAsB,UAACC,GAAD,EAAQ;eACrBC,IAAP,CAAY,MAAMD,IAAI,CAAJ,CAAN,GAAe,GAA3B;OADF;aAGOC,IAAP,CAAY,OAAZ;WACKlB,GAAL,CAASkB,IAAT,CAAcH,MAAd;;aAEOI,IAAP,CAAY,UAACC,CAAD,EAAIC,IAAJ,EAAa;;YAEnBC,UAAU,EAAd;YACIC,QAAQjB,EAAEe,IAAF,CAAZ;YACIG,YAAYD,MAAMT,IAAN,CAAW,UAAX,CAAhB;;eAEKxB,QAAL,CAAc0B,OAAd,CAAsB,UAACC,GAAD,EAAQ;;cAExBQ,YAAY,EAAhB;oBACUN,IAAV,CAAe,UAACO,CAAD,EAAIC,IAAJ,EAAY;gBACrBC,QAAQtB,EAAEqB,IAAF,CAAZ;gBACIE,UAAUD,MAAMd,IAAN,CAAW,UAAX,EAAuBgB,IAAvB,EAAd;;gBAEIb,IAAI,CAAJ,KAAUY,OAAd,EAAuB;0BACTD,MAAMd,IAAN,CAAW,YAAX,EAAyBgB,IAAzB,EAAZ;;WALJ;kBAQQZ,IAAR,CAAa,MAAMO,SAAN,GAAkB,GAA/B;SAXF;;YAcIM,iBAAiBR,MAAMT,IAAN,CAAW,gBAAX,EAA6BgB,IAA7B,EAArB;gBACQZ,IAAR,CAAaa,cAAb;;eAEK/B,GAAL,CAASkB,IAAT,CAAcI,OAAd;OAvBF;;;;8BA2BQ;;;UACJU,aAAa,8BAAjB;WACKhC,GAAL,CAASgB,OAAT,CAAiB,UAACiB,SAAD,EAAYC,KAAZ,EAAoB;YAC/BC,aAAaF,UAAUG,IAAV,CAAe,GAAf,CAAjB;sBACcF,QAAQ,OAAKlC,GAAL,CAASqC,MAAjB,GAA0BF,aAAY,IAAtC,GAA6CA,UAA3D;OAFF;;UAKIG,aAAaC,UAAUP,UAAV,CAAjB;UACIQ,OAAO1D,SAAS2D,aAAT,CAAuB,GAAvB,CAAX;WACKC,YAAL,CAAkB,MAAlB,EAA0BJ,UAA1B;WACKI,YAAL,CAAkB,UAAlB,EAA8B,cAA9B;eACSC,IAAT,CAAcC,WAAd,CAA0BJ,IAA1B,EAXQ;WAYHK,KAAL;;;;iCAGW;;;UACPC,UAAUxC,EAAE,SAAF,CAAd;cACQyC,IAAR;UACIC,WAAWF,QAAQhC,IAAR,CAAa,UAAb,CAAf;eACSmC,KAAT;;WAEKjD,GAAL,CAASgB,OAAT,CAAiB,UAACK,IAAD,EAAOD,CAAP,EAAa;YACxBA,IAAI,CAAR,EAAW;cACLG,QAAQjB,EAAE,oDAAF,CAAZ;eACKU,OAAL,CAAa,UAACkC,KAAD,EAAQC,CAAR,EAAc;gBACrBlC,MAAM,OAAKjB,GAAL,CAAS,CAAT,EAAYmD,CAAZ,EAAeC,OAAf,CAAuB,IAAIC,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAvB,EAA6C,EAA7C,CAAV;oBACQH,MAAME,OAAN,CAAc,IAAIC,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAd,EAAoC,EAApC,CAAR;gBACIC,QAAQhD,EAAE,gBAAgBW,GAAhB,GAAsB,mBAAtB,GAA4CiC,KAA5C,GAAoD,aAAtD,CAAZ;gBACIC,KAAK9B,KAAKgB,MAAL,GAAc,CAAvB,EAA0B;sBAChB/B,EAAE,gBAAgBW,GAAhB,GAAsB,yEAAtB,GAAkGiC,KAAlG,GAA0G,UAA5G,CAAR;;kBAEIK,MAAN,CAAaD,KAAb;WAPF;mBASSC,MAAT,CAAgBhC,KAAhB;;OAZJ;;;;;;AAoBJzC,SAASY,gBAAT,CAA0B,kBAA1B,EAA8C;SAAS,IAAIN,IAAJ,EAAT;CAA9C;;"}